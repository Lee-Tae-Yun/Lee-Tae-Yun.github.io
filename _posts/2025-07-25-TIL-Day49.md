---
title: "[Day 49] Reactive Programming"
description: "RxSwiftë¥¼ ì‚¬ìš©í•˜ì—¬ Reactive Rrogrammingí•˜ê¸°! Part.3"
date: 2025-07-25
categories: [TIL]
tags: [Swift, iOS, Reactive Programming, RxSwift, Observable, Operators, Scheduler, Traits, Subject, Relay, RxCocoa]
pin: false
math: true
mermaid: true
# published: false
# image:
#   path:
#   lqip: 
#   alt: 
---
## ğŸ“Œ Scheduler

`Scheduler`ëŠ” `Obsevable` ì—°ì‚°ìë“¤ì´ ë™ì‘í•˜ëŠ” ì‹¤í–‰ `Context(Thread)`ë¥¼ **ì •ì˜í•˜ëŠ” ê°ì²´**ì—ìš”.

Rxì—ì„œì˜ ì—°ì‚°ì€ **ê¸°ë³¸ì ìœ¼ë¡œ ë™ê¸°ì **ì´ê³ , **í˜„ì¬ ìŠ¤ë ˆë“œì—ì„œ ì‹¤í–‰**ë˜ì§€ë§Œ, `subscribe(on:)`ê³¼ `obseve(on:)`ì„ ì‚¬ìš©í•˜ë©´ ëª…ì‹œì ìœ¼ë¡œ ì‹¤í–‰ **Threadë¥¼ ì œì–´ê°€ ê°€ëŠ¥**í•´ìš”

ì˜ˆì‹œë¥¼ í•œë²ˆ ë³¼ê²Œìš”

```swift
let mainScheduler = MainScheduler.instance
let backgroundScheduler = ConcurrentDispatchQueueScheduler(qos: .background)

Observable<Int>.just(100)
  .subscribe(on: backgroundScheduler) // Observable ì‹œì‘ì€ ë°±ê·¸ë¼ìš´ë“œì—ì„œ
  .map { $0 * 10 }                    // ì—¬ì „íˆ ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì‹¤í–‰
  .observe(on: mainScheduler)         // ì´ ì‹œì ë¶€í„° ë©”ì¸ ìŠ¤ë ˆë“œë¡œ ì´ë™
  .filter { $0.isMultiple(of: 20) }   // ë©”ì¸ ìŠ¤ë ˆë“œì—ì„œ ì‹¤í–‰
  .subscribe(onNext: { print($0) })   // ë©”ì¸ ìŠ¤ë ˆë“œì—ì„œ ê²°ê³¼ ì²˜ë¦¬
  .disposed(by: disposeBag)
```

-	subscribe(on:) â†’ ë¬´ê±°ìš´ ì‘ì—…(ì˜ˆ: ë„¤íŠ¸ì›Œí¬ ìš”ì²­, íŒŒì¼ ì½ê¸° ë“±)ì€ ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì²˜ë¦¬í•˜ê³ 
- observe(on:) â†’ UI ì‘ì—…ì€ ë¬´ì¡°ê±´ ë©”ì¸ ìŠ¤ë ˆë“œì—ì„œ í•´ì•¼ í•˜ë‹ˆê¹Œ ê·¸ ì „ì— ë°”ê¿”ì£¼ëŠ” ê±°ì—ìš”.

### subscribe(on:) ê³¼ observe(on:)ì˜ ì°¨ì´
|  | subscribe(on:) | observe(on:) |
| --- | --- | --- |
| ëª©ì  | Observableì´ ìƒì„±ë˜ê³  ì‹¤í–‰ë˜ëŠ” Threadë¥¼ ê²°ì • | ì´ë²¤íŠ¸ê°€ ì²˜ë¦¬ë˜ëŠ” Threadë¥¼ ì§€ì • |
| ì‹œì  | Observable Chain ê°€ì¥ ì²˜ìŒ ì˜í–¥ | í˜¸ì¶œ ì´í›„ ëª¨ë“  Chain ì˜í–¥ |
| ì˜ˆì‹œ | .subscribeOn(ConcurrentDispatchQueueScheduler(qos: .background)) | .observeOn(MainScheduler.instance) |



### ì£¼ìš” Scheduler ì¢…ë¥˜
| Scheduler | ì„¤ëª… | ì£¼ë¡œ ì“°ëŠ” ìš©ë„ |
| --- | --- | --- |
| `MainScheduler.instance` | ë©”ì¸ ìŠ¤ë ˆë“œ(UI Thread) | UI ì—…ë°ì´íŠ¸ |
| `ConcurrentDispatchQueueScheduler` | GCDì˜ ë°±ê·¸ë¼ìš´ë“œ í | ë„¤íŠ¸ì›Œí¬ ìš”ì²­, ë””ìŠ¤í¬ ì‘ì—… ë“± |
| `SerialDispatchQueueScheduler` | GCDì˜ ì§ë ¬ í | ìˆœì„œ ë³´ì¥í•´ì•¼ í•˜ëŠ” ì‘ì—… |
| `OperationQueueScheduler` | OperationQueue ê¸°ë°˜ | ë³µì¡í•œ ë°±ê·¸ë¼ìš´ë“œ ì‘ì—… |
| `ImmediateSchedulerType` | ì§€ì—° ì—†ì´ ì¦‰ì‹œ ì‹¤í–‰ | í…ŒìŠ¤íŠ¸ìš© í˜¹ì€ ë‹¨ìˆœ ì—°ì‚° |
| `CurrentThreadScheduler` | í˜„ì¬ ìŠ¤ë ˆë“œì—ì„œ ì‹¤í–‰ | ì§€ì—° ì—†ì´ í˜„ì¬ íë¦„ì—ì„œ ì²˜ë¦¬ |


## ğŸ“Œ Traits

TraitsëŠ” íŠ¹ì •í•œ ì œì•½ê³¼ ì˜ë¯¸ë¥¼ ë¶€ì—¬í•œ Observableì˜ ì¶”ìƒí™”ëœ í˜•íƒœì—ìš”
ëª¨ë“  TraitsëŠ” asObservable() ì—°ì‚°ì„ í†µí•´ Observableë¡œ ë³€í™˜ì´ ê°€ëŠ¥í•˜ë‹¤!

ë¨¼ì € ê°„ë‹¨í•˜ê²Œ Traitsì— ëŒ€í•´ ë­ê°€ ìˆëŠ”ì§€ ì‚´í´ ë³´ì

| Traits | ì„¤ëª… | ìš©ë„ | ì´ë²¤íŠ¸ |
| ------ | --- | --- | ---- |
| `Single` | í•˜ë‚˜ì˜ Element | Dataê°€ 1íšŒë§Œ ë°œìƒí•  ë•Œ <br> (ë„¤íŠ¸ì›Œí¬ API, DB ì¿¼ë¦¬) | success(Element) <br> failure(Error) |
| `Completable` | Completed ë˜ëŠ” Error ë°©ì¶œ | Data ì—†ì´ ì™„ë£Œ ì—¬ë¶€ë§Œ í•„ìš”í•  ë•Œ | completed <br> error(Error) |
| `Maybe` | í•˜ë‚˜ì˜ Element ë˜ëŠ” Completed, Error ë°©ì¶œ | Optionalí•œ ë°ì´í„° íë¦„ | success(Element) <br> completed <br> error(Error) |
| `Infallible` | í•˜ë‚˜ì˜ Element ë˜ëŠ” Completed ë°©ì¶œ | Errorê°€ ì—†ëŠ” ì´ë²¤íŠ¸ íë¦„ | next(Element) <br> completed |

### Single

```swift
Single<UIImage>.create { single in
  downloadImage { result in
    switch result {
    case .success(let image): // success(Element)
      single(.success(image))
    case .failure(let error): // failure(Error)
      single(.failure(error))
    }
  }
  return Disposables.create()
}
```
- `success(Element)`ë‚˜ `failure(Error)`ì¤‘ í•˜ë‚˜ë§Œ ë°œìƒ!

### Complettable

```swift
Completable.create { completable in
  saveToDatabase { success in
    success ? completable(.completed) : completable(.error(MyError.db)) // completed or error(Error)
  }
  return Disposables.create()
}
```
- ë°ì´í„°ëŠ” ëª¨ë¥´ê² ê³ , ì„±ê³µí–ˆëŠ”ì§€, ì‹¤íŒ¨í–ˆëŠ”ì§€ë§Œ ì•Œê³  ì‹¶ì„ë–„!

### Maybe

```swift
Maybe<String>.create { maybe in
  if isValidUser {
    maybe(.success("UserName"))
  } else {
    maybe(.completed) // ì•„ë¬´ ê°’ë„ ì—†ì´ ì¢…ë£Œ
  }
  return Disposables.create()
}
```
- `success`, `completed`, `error` 3ê°€ì§€ ì¤‘ í•˜ë‚˜ ë°œìƒ
### Infallible

```swift
func loadUserSettings() -> Infallible<Settings> {
  return Infallible.create { infallible in
    loadSettings {
      infallible(.next($0))
      infallible(.completed)
    }
    return Disposables.create()
  }
}
```
- errorê°€ ì ˆëŒ€ ì—†ëŠ” ìƒí™©ì—ì„œ ì‚¬ìš©!
  - ê°’ë§Œ ì „ë‹¬í•˜ê³  ì„±ê³µ/ì™„ë£Œë¡œ ëë‚˜ëŠ” ë‹¨ìˆœí•œ ìŠ¤íŠ¸ë¦¼
  - ì—ëŸ¬ ì²˜ë¦¬ë¥¼ ìƒëµí•˜ê³  ì‹¶ì€ UI ë°ì´í„° ë°”ì¸ë”©

## ğŸ“Œ Subject and Relay

**Subject**ì™€ **Relay**ëŠ” RxSwiftì™€ RxCocoaì—ì„œ í•µì‹¬ì ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” **Hot Obsevable**ì´ì—ìš”.

**Subject**ì™€ **Relay**ëŠ” **`Observableì´ë©´ì„œ Observerì˜ ì—­í• `** ì„ í•œë‹µë‹ˆë‹¤.

|  | Subject (RxSwift) | Relay (RxRelay) |
| --- | ----------------- | --------------- |
| ì˜¤ë¥˜ ë°©ì¶œ | âœ… | âŒ |
| ìŠ¤íŠ¸ë¦¼ ì™„ë£Œ | âœ… | âŒ |
| ì¢…ë¥˜ | **PublicshSubject** <br> **BehaviorSubject** <br> **ReplaySubject** <br> **AsyncSubJect** | **PublishRelay** <br> **BehaviorRelay** |

ê°ê°ì˜ ì˜ˆì‹œ ì½”ë“œì™€ ì •ì˜ë¥¼ ì•Œì•„ë³¼ê¹Œìš”??

### PublicshSubject

**êµ¬ë… ì´í›„ì— ë°œìƒë˜ëŠ” ì´ë²¤íŠ¸ë§Œ ì „ë‹¬í•˜ë©°, ì´ì „ ì´ë²¤íŠ¸ëŠ” ê¸°ì–µí•˜ì§€ ì•Šì•„ìš”.**
```swift
let publishSubject = PublishSubject<Int>()
publishSubject
  .subscribe(onNext: {
    print($0)
  })
  .disposed(by: disposeBag)
publishSubject.on(.next(1))
publishSubject.on(.next(2))
publishSubject.on(.next(3))
publishSubject.on(.completed)
```

**ì¼ë°˜ì ì¸ ì´ë²¤íŠ¸ ì²˜ë¦¬ë‚˜ ë‹¨ë°œì„± ì•Œë¦¼ì— ì í•©í•´ìš”**

### BehaviorSubject

**ë°˜ë“œì‹œ ì´ˆê¸°ê°’ì´ í•„ìš”í•˜ë©°, ê°€ì¥ ìµœê·¼ì˜ ì´ë²¤íŠ¸ í•˜ë‚˜ë¥¼ ì €ì¥í•˜ê³ , êµ¬ë…ì‹œ ì¦‰ì‹œ ì „ë‹¬í•©ë‹ˆë‹¤.**
```swift
let behaviorSubject = BahaviorSubject(value: 0)
behaviorSubject
  .subscribe(onnext: {
    print($0)
  })
  .disposed(by: disposeBag)
behaviorSubject.on(.next(1))
behaviorSubject.on(.next(2))
behaviorSubject.on(.next(3))
behaviorSubject.on(.completed)
```

**ìƒíƒœë¥¼ ê³„ì† ì¶”ì í•˜ê³  ìµœì‹  ìƒíƒœë¥¼ ê³µìœ í•  ë•Œ ì í•©í•´ìš”**

### ReplaySubject

**ì§€ì • ëœ ë²„í¼ í¬ê¸° ë§Œí¼ì˜ ì´ì „ ì´ë²¤íŠ¸ë¥¼ ì €ì¥í•˜ê³ , êµ¬ë…ì‹œ ë²„í¼ì— ì €ì¥ëœ ëª¨ë“  ì´ë²¤íŠ¸ë¥¼ ì¦‰ì‹œ ì „ë‹¬í•´ìš”**
```swift
let replySubject = ReplaySubject<Int>.create(bufferSize: 2)
replySubject.on(.next(1))
replySubject.on(.next(2))
replySubject
  .subscribe(onNext: {
    print($0)
  })
  .disposed(by: disposeBag)
replySubject.on(.next(3))
replySubject.on(.completed)
```

**ê°’ì˜ íˆìŠ¤í† ë¦¬ë¥¼ ìœ ì§€í•´ì•¼ í•  ë•Œ ì í•©í•´ìš”**

### AsyncSubJect

**completed ì´ë²¤íŠ¸ ë°œìƒì‹œ, ê°€ì¥ ë§ˆì§€ë§‰ ê°’ì„ ì „ë‹¬í•´ìš”**

```swift
let asyncSubject = AsyncSubject<Int>()
asyncSubject
  .subscribe(onNext: {
    print($0)
  })
  .disposed(by: disposeBag)
asyncSubject.on(.next(1))
asyncSubject.on(.next(2))
asyncSubject.on(.next(3))
asyncSubject.on(.completed)
```

**ì‘ì—…ì´ ëë‚œ ë’¤ ìµœì¢… ê²°ê³¼ë§Œ í•„ìš”í•  ê²½ìš° ì í•©í•´ìš”**

### PublishRelay

**PublishSubjectì—ì„œ ì—ëŸ¬ì™€ ì™„ë£Œ ì´ë²¤íŠ¸ë¥¼ ì œê±°í•œ í˜•íƒœì—ìš”**

```swift
let publishRelay = PublishRelay<Int>()
publishRelay
  .subscribe(onNext: {
    print($0)
  })
  .disposed(by: disposeBag)
publishRelay.accept(1)
publishRelay.accept(2)
publishRelay.accept(3)
```

**UIì´ë²¤íŠ¸ ì²˜ë¦¬ì²˜ëŸ¼ ì—ëŸ¬ê°€ ë‚˜ë©´ ì•ˆë˜ëŠ” ìƒí™©ì— ì í•©í•´ìš”**

### BehaviorRelay

**BehaviorSubjectì—ì„œ ì—ëŸ¬ì™€ ì™„ë£Œë¥¼ ì œê±°í•œ í˜•íƒœë¡œ, í˜„ì¬ ìƒíƒœ ê°’ì„ ì €ì¥í•˜ê³  êµ¬ë…ì‹œ ì „ë‹¬í•´ìš”**

```swift
let behaviorRelay = BehaviorRelay(value: 0)
behaviorRelay
  .subscribe(onNext: {
    print($0)
  })
  .disposed(by: disposeBag)
behaviorRelay.accept(1)
behaviorRelay.accept(2)
behaviorRelay.accept(3)
```

**ë§ˆì°¬ê°€ì§€ë¡œ UIì´ë²¤íŠ¸ ì²˜ë¦¬ì²˜ëŸ¼ ì—ëŸ¬ê°€ ë‚˜ë©´ ì•ˆë˜ëŠ” ìƒí™©ì— ì í•©í•´ìš”**

## ğŸ“Œ RxCocoa

RxSwiftë¥¼ UIKit, AppKitë“± `Appleì˜ UIí”„ë ˆì„ì›Œí¬ì— í†µí•©í•˜ê¸° ìœ„í•œ í™•ì¥ ë¼ì´ë¸ŒëŸ¬ë¦¬`ì—ìš”

  ![RxCocoa PNG](/assets/img/day49_RxCocoa.png)

|     | Binder | ControlEvent | ControlProperty |
| --- | ------ | ------------ | --------------- |
| ë°©í–¥ | ë‹¨ë°©í–¥(State â†’ UI) | ë‹¨ë°©í–¥(UI â†’ State) | ì–‘ë±¡í–¥ |
| íƒ€ì… | State | Event | State + Evnet |
| ëª©ì  | UI ê°’ ë°”ì¸ë”© | UI ì´ë²¤íŠ¸ ìˆ˜ì‹  | UI ê°’ ë°”ì¸ë”© <br> UI ì´ë²¤íŠ¸ ìˆ˜ì‹  |
| ì˜ˆì‹œ | ëª¨ë“  UI Property <br> @dynamicMemberLookupìœ¼ë¡œ ìë™ ìƒì„± | UIButton.rx.tap <br> UIScrollerView.rx.didScroll <br> UICollectionView.rx.itemSeleted | UITextFiedld.rx.text <br> UISwitch.rx.isOn <br> UISlider.rx.value <br> UIDatePicker.rx.date |

ê°„ë‹¨í•œ ì‚¬ìš©ì ì •ì˜ Binder, ControlEvent, ControlProperty ë¥¼ ë§Œë“¤ì–´ ë³¼ê¹Œìš”?

```swift
class MyButton: UIControl {
  ..
}

extension Reactive where Base: MyButton {
  var tap: ControlEvent<Void> {
    controlEvent(.touchUpInside)
  }
}

class MyToggleSwitch: UIControl {
  var isOn: Bool = false
  ...
}

extension Reactive where Base: MyToggleSwitch {
    var isOn: ControlProperty<Bool> {
    controlProperty(editingEvents: .valueChanged) { toggleSwitch in
      toggleSwitch.isOn
    } setter: { toggleSwitch, isOn in
      toggleSwitch.isOn = isOn
    }
  }
}
```



## ë§ºìœ¼ë©°: ì¶˜ì‹ì´ì™€ í•¨ê»˜í•˜ëŠ” ìŠ¤ë§ˆíŠ¸í•œ ê°œë°œ

**ì˜¤ëŠ˜ë„ ì˜¤ë¥˜ ë‚´ë©° ìë€ ì¶˜ì‹ì´ì˜€ìŠµë‹ˆë‹¤. ğŸ¾**
**ë” ì—´ì‹¬íˆ ë…¸ë ¥ í•´ì„œ ì¢‹ì€ iOS Developerê°€ ë˜ì!**

> **í˜¹ì‹œ ì´ ê¸€ì„ ë³´ì‹œëŠ” ë¶„ë“¤ ì¤‘ ë” ìœ ìš©í•œ íŒì´ ìˆë‹¤ë©´ ëŒ“ê¸€ë¡œ ë§ì´ ì•Œë ¤ì£¼ì„¸ìš”!**